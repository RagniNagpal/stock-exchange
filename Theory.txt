ðŸ¦ **Stock Exchange Project â€” Complete Notes**

---

### ðŸ”¹ **Concept Overview**

In a **Stock Exchange**, every trade involves swapping **one asset for another** â€”
basically converting one asset type into another.

* **Base Asset:** Stock (e.g., ETH, BTC, TATA, INFY)
* **Quote Asset:** Currency used for trading (e.g., INR, USD)
* Example: **ETH-BTC** â†’ 1 ETH is traded in terms of BTC (two-asset market)

---

### ðŸ“Š **Core Components of the Market**

#### 1. **Current Price**

Shows the **latest trading price** of the asset.

#### 2. **Order Book**

* Continuously changing list of **buy (bid)** and **sell (ask)** orders.
* It maintains all open orders that are **not yet matched**.

| Type    | Role   | Meaning                                   |
| ------- | ------ | ----------------------------------------- |
| **Bid** | Buyer  | Willing to buy stock at a specific price  |
| **Ask** | Seller | Willing to sell stock at a specific price |

The **Order Book** maintains liquidity and reflects **real-time market movement**.

---

### âš™ï¸ **Types of Orders**

#### ðŸŸ© 1. **Limit Order**

> Buy or Sell at a specific price only (not the current market price).

* Example:
  Current price = â‚¹100
  You want to buy only if it drops to â‚¹95 â†’ this is a **limit order**.
* Execution happens **only when the market price reaches the limit price**.

#### ðŸŸ¥ 2. **Market Order**

> Buy or Sell immediately at the **best available prices**.

* May execute at **multiple prices** to fulfill full quantity.
* Example: You want 100 shares â€”

  * 30 shares available at â‚¹100
  * 70 shares available at â‚¹102
    â†’ order executes in both prices.

---

### ðŸ” **When Trade Happens**

A **trade executes** when:

```
Bid price == Ask price
```

Then, both orders are matched, and the transaction moves to the **Trade History** section.

---

### ðŸ•¯ï¸ **Candlestick Chart (Price Movement)**

Used to visualize stock trends.

| Candle Type         | Condition                     | Meaning         |
| ------------------- | ----------------------------- | --------------- |
| ðŸŸ¢ **Green Candle** | Closing Price > Opening Price | Price Increased |
| ðŸ”´ **Red Candle**   | Opening Price > Closing Price | Price Decreased |

Each candle also has:

* **Upper Wick (Shadow):** Maximum price of the day
* **Lower Wick (Shadow):** Minimum price of the day

---

### ðŸ’° **Market Makers**

* Provide **liquidity** in the market (bring buyers and sellers).
* Stock owners often contact them to **increase liquidity**.
* More buyers/sellers â†’ Better liquidity â†’ Stable prices.
* Low liquidity stocks are **risky to trade**.

---

### âš–ï¸ **Every Order is a Limit Order**

Even **Market Orders** internally act as **Limit Orders** with system-defined limits.

**Example:**
If multiple sellers exist:

* â‚¹1cr, â‚¹1.5cr, â‚¹2cr, â‚¹8cr

You have â‚¹8cr, so youâ€™d prefer to buy from cheaper ones first.
But if those lower-priced sellers remove their offers,
then your **Market Order** could buy at â‚¹8cr â†’ loss.

To avoid this, exchanges apply a **hidden limit** â€”
so the order executes only within a safe price band.
ðŸ‘‰ This hidden limit is called a **Quote Order**.

---

### âš ï¸ **Circuit Breakers**

| Type              | Meaning                                     |
| ----------------- | ------------------------------------------- |
| **Upper Circuit** | No more sellers (price rising continuously) |
| **Lower Circuit** | No more buyers (price falling continuously) |

These prevent **extreme volatility** in the market.

---

### ðŸŒ€ **â€œWaveâ€ in Market**

* A **single large trader or institution** who buys huge quantities of stock.
* Causes price manipulation and reduces normal market activity.
* Such traders can control short-term price movement.

---

## ðŸ§© **Technical Implementation (Project Architecture)**

### ðŸ§  **We use Binance API**

* Binanceâ€™s APIs are industry standard.
* Weâ€™ll use **same structure, schema, and response format** as Binance.
* All real-time data (prices, order books, trades) fetched or simulated via these APIs.

---

### âš¡ **Order Book Storage (In-Memory System)**

* Trading requires **millisecond-level performance**.
* Fetching from database each time = too slow.
* Therefore, the **Order Book** is maintained **in memory**.

ðŸ§  Example: Redis or in-memory Node.js object.

**Advantage:**
Ultra-fast matching and order updates.

---

### ðŸš§ **Difficulties in Implementation**

#### 1. **Scalability Issue**

* Because order books are in-memory,
  â†’ cannot horizontally scale (multiple servers canâ€™t share same memory easily).

âœ… **Solution:**

* Run Order Book as a **separate process/service** (e.g., in Node.js).
* Communicate via **message queue** (RabbitMQ, Kafka, Redis Streams).
* Allows scaling by distributing load across multiple order book processes.

---

#### 2. **Data Crash / Fault Tolerance**

* If the in-memory data crashes, all active orders could be lost.

âœ… **Solution:**

* Maintain all order events in a **Queue**.
* If crash occurs â†’ replay events from queue to **restore state**.

---

## ðŸ—ï¸ **Project Architecture â€” Step-by-Step Flow**

### ðŸ§© 1. Browser â†’ API Server

User performs Buy/Sell â†’ request sent to API server.

* Server validates and creates an **Order ID**.
* Order details sent to **Queue** for processing.

---

### ðŸ§© 2. Queue â†’ Order Book Process

The **Order Book Process** (running separately) reads from queue.

* Matches new orders with existing ones.
* Executes trades or marks pending ones.
* Updates the in-memory Order Book.

---

### ðŸ§© 3. Order Book â†’ Queue (Updated Data)

* After processing, updated data (trades, pending orders) is sent back to another queue.
* This ensures **real-time consistency** and **crash recovery**.

---

### ðŸ§© 4. Queue â†’ WebSocket â†’ Browser

* The **WebSocket server** reads the updated data queue.
* Pushes live data to browsers â€” showing live prices, order book updates, and trade history instantly.

---

### ðŸ§© 5. Database Sync

* Periodically or after every update,
  the system stores order/trade history from queue â†’ database (for analytics & record).

---

### ðŸ§± **Tech Stack (Possible)**

| Layer           | Technology                       |
| --------------- | -------------------------------- |
| Backend         | Node.js / Express                |
| Realtime        | WebSockets                       |
| Queue           | RabbitMQ / Redis Streams / Kafka |
| In-Memory Store | Redis / Node.js memory           |
| Database        | MongoDB / PostgreSQL             |
| API             | Binance API structure            |
| Frontend        | React / HTML-CSS-JS              |

---

## âš¡ **Key Takeaways**

* Every order = Limit order** (market order has hidden limit).
* Order Book = In-memory for high speed.
* Queue System = Backbone for scalability and recovery.
* Market Makers = Liquidity providers.**
* WebSockets keep browser data real-time.
* Binance API used for realistic structure & responses.



//Day2

bids ko desc asks ko asc bids(buyers)

buy >= limit price in sell



  Pub/sub=> publisher and subscriber design pattern which we used for real-time updates, communication bw multiple component in microservice architecture without knowing each other or having any direct connection

  1. Monolith-> cannot scale a particular component sava server scale karna padega
  2. Microservice-> har cheez ke liye alag server 
  3 methods to comm kafka and blog -> 1. api, 2. socket, 3. pubsub

  pubsub have channel -  which have connection with publisher and subscriber
  pubsub has fire and forget...........eq agar 9 bje ek show start ua usne gana bhej diya 9:15 par subscribe  to isko gana nhi milega ....kyunki subsribe nhi kiya usne 

  bina client -> web socket
  client ke saath-> polling